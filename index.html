<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tra cứu dữ liệu ống</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input[type="text"] {
      padding: 5px;
      margin-right: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:hover {
      background-color: #f9f9f9;
    }
    .summary {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Tra cứu dữ liệu từ JSON</h2>
  <div>
    <input type="text" id="filter1" placeholder="品种">
    <input type="text" id="filter2" placeholder="口径">
    <input type="text" id="filter3" placeholder="形式">
    <input type="text" id="filter4" placeholder="长度">
  </div>

  <div class="summary">
    Tổng 支数: <span id="totalQty">0</span> | Tổng 重量吨: <span id="totalWeight">0</span>
  </div>

  <table id="dataTable">
    <thead>
      <tr>
        <th>品种</th><th>口径</th><th>形式</th><th>长度</th><th>支数</th><th>组合</th><th>重量</th><th>重量吨</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let data = [];

    function fetchData() {
    $.getJSON("https://raw.githubusercontent.com/quangthanhqldd/gg/main/gg.json", function(response) {
        data = response;
        renderTable();
      });
    }

    function renderTable() {
      const f1 = $('#filter1').val().toLowerCase();
      const f2 = $('#filter2').val().toLowerCase();
      const f3 = $('#filter3').val().toLowerCase();
      const f4 = $('#filter4').val().toLowerCase();

      let totalQty = 0;
      let totalWeight = 0;
      const filtered = data.filter(row => {
        return (!f1 || row["品种"].toLowerCase().includes(f1)) &&
               (!f2 || row["口径"].toString().toLowerCase().includes(f2)) &&
               (!f3 || row["形式"].toLowerCase().includes(f3)) &&
               (!f4 || row["长度"].toString().toLowerCase().includes(f4));
      });

      const rows = filtered.map(row => {
        const qty = parseFloat(row["支数"]);
        const weight = parseFloat(row["重量吨"]);
        totalQty += isNaN(qty) ? 0 : qty;
        totalWeight += isNaN(weight) ? 0 : weight;
        return `<tr>
                  <td>${row["品种"]}</td>
                  <td>${row["口径"]}</td>
                  <td>${row["形式"]}</td>
                  <td>${row["长度"]}</td>
                  <td>${row["支数"]}</td>
                  <td>${row["组合"]}</td>
                  <td>${row["重量"]}</td>
                  <td>${row["重量吨"]}</td>
                </tr>`;
      });

      $('#dataTable tbody').html(rows.join(""));
      $('#totalQty').text(totalQty);
      $('#totalWeight').text(totalWeight.toFixed(3));
    }

    $(document).ready(function() {
      fetchData();
      $('#filter1, #filter2, #filter3, #filter4').on('input', renderTable);
    });
  </script>
</body>
</html>
